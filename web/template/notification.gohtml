{{ define "title" }}{{ T "general.login-title" }}{{ end }}

{{ define "head" }}{{ end }}

{{ define "body" }}
  <div class="centered">
    {{ if eq .Type 1 }}
      <h1>{{ .LiveTitle }}{{ T "notifications.live-edited-suffix-main" }}</h1>
      {{ template "edited-table" . }}
    {{ else if eq .Type 2 }}
      <h1>{{ .LiveTitle }}{{ T "notifications.live-deleted-suffix-main" }}</h1>
      {{ template "deleted-table" . }}
    {{ else if eq .Type 3 }}
      <h1>{{ .LiveTitle }}{{ T "notifications.live-added-suffix-main" }}</h1>
      {{ template "added-table" . }}
    {{ end }}
  </div>
{{ end }}

{{ define "added-table" }}
  <table class="bottom-item">
    <tbody>
      {{ range $notificationField := .NotificationFields.Sort }}
        {{ if not (eq $notificationField.Type 8) }}
          <tr>
            <td>{{ T $notificationField.Type.String }}</td>
            <td>{{ $notificationField.NewValue }}</td>
          </tr>
        {{ else }}
          <tr>
            <td>{{ T $notificationField.Type.String }}</td>
            <td>
              {{ template "artist-list" ParseSlice $notificationField.NewValue }}
            </td>
          </tr>
        {{ end }}
      {{ end }}
    </tbody>
  </table>
{{ end }}

{{ define "deleted-table" }}
  <table class="bottom-item">
    <tbody>
      {{ range $notificationField := .NotificationFields.Sort }}
        {{ if not (eq $notificationField.Type 8) }}
          <tr>
            <td>{{ T $notificationField.Type.String }}</td>
            <td class="old-table-data">{{ $notificationField.OldValue }}</td>
          </tr>
        {{ else }}
          <tr>
            <td>{{ T $notificationField.Type.String }}</td>
            <td class="old-table-data">
              {{ template "artist-list" ParseSlice $notificationField.OldValue }}
            </td>
          </tr>
        {{ end }}
      {{ end }}
    </tbody>
  </table>
{{ end }}

{{ define "edited-table" }}
  <table class="bottom-item">
    <tbody>
      {{ range $notificationField := .NotificationFields.Sort }}
        {{ $isChanged := not (eq $notificationField.OldValue $notificationField.NewValue) }}
        {{ if not (eq $notificationField.Type 8) }}
          <tr>
            <td>{{ T $notificationField.Type.String }}</td>
            {{ if $isChanged }}
              <td class="old-table-data">{{ $notificationField.OldValue }}</td>
              <td class="new-table-data">{{ $notificationField.NewValue }}</td>
            {{ else }}
              <td colspan="2">{{ $notificationField.NewValue }}</td>
            {{ end }}
          </tr>
        {{ else }}
          {{ template "artist-table-row" $notificationField }}
        {{ end }}
      {{ end }}
    </tbody>
  </table>
{{ end }}

{{ define "artist-list" }}
  <ul class="artist-list">
    {{ range $line := . }}
      <li>{{ $line }}</li>
    {{ end }}
  </ul>
{{ end }}

{{ define "artist-table-row" }}
  {{ $fieldLines := GetFieldLines . }}
  <tr>
    <td>{{ T .Type.String }}</td>
    <td class="old-artists">
      <ul class="artist-list">
        {{ range $line := $fieldLines }}
          {{ template "artist-span" $line.Old }}
        {{ end }}
      </ul>
    </td>
    <td class="new-artists">
      <ul class="artist-list">
        {{ range $line := $fieldLines }}
          {{ template "artist-span" $line.New }}
        {{ end }}
      </ul>
    </td>
  </tr>
{{ end }}

{{ define "artist-span" }}
  <li
    {{ if .IsHighlighted }}
      class="highlighted"
    {{ end }}
  >
    {{- if .InnerText -}}
      {{ .InnerText }}
    {{- else -}}
      &nbsp;
    {{- end -}}
  </li>
{{ end }}
